<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Anonymised">

<title>Gardens fill seasonal hunger gaps for farmland pollinators</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Urban-rural analysis code_files/libs/clipboard/clipboard.min.js"></script>
<script src="Urban-rural analysis code_files/libs/quarto-html/quarto.js"></script>
<script src="Urban-rural analysis code_files/libs/quarto-html/popper.min.js"></script>
<script src="Urban-rural analysis code_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Urban-rural analysis code_files/libs/quarto-html/anchor.min.js"></script>
<link href="Urban-rural analysis code_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Urban-rural analysis code_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Urban-rural analysis code_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Urban-rural analysis code_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Urban-rural analysis code_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Gardens fill seasonal hunger gaps for farmland pollinators</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Anonymised </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="study-background" class="level2">
<h2 class="anchored" data-anchor-id="study-background">Study background</h2>
<p>Our study investigated the potential for gardens to have a widespread role in buffering pollinator populations against seasonal shortages in nectar supply by answering the following four questions: 1) Do gardens fill seasonal gaps in the nectar supply of farmland landscapes? 2) Do pollinators increase their use of gardens during gaps in farmland resource availability? 3) Are farmland pollinator populations impacted by the removal or alteration of garden nectar supply? 4) How much of Great Britain is within reach of a garden for a foraging pollinator? Using bumblebees as a model group, and Southwest UK as a study region, we test these four hypotheses using a combination of empirical field data, agent-based-modelling and GIS mapping.</p>
<p>The code in this document shows how each prediction was tested and visualised.</p>
</section>
<section id="setting-up-the-r-environment" class="level2">
<h2 class="anchored" data-anchor-id="setting-up-the-r-environment">Setting up the R environment</h2>
<p>Set working directory to wherever the data files are stored</p>
<p>Now clear workspace and load packages:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list=</span><span class="fu">ls</span>()) <span class="co">#clear workspace </span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">#### Load packages</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tinytex) </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mgcv) </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2) </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr) </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales) </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nlme) </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MuMIn) </span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans) </span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp) </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(contrast) </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr) </span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotrix) </span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(broom) </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Rmisc) </span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(svglite)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="running-code-for-each-of-the-4-predictions" class="level2">
<h2 class="anchored" data-anchor-id="running-code-for-each-of-the-4-predictions">Running code for each of the 4 predictions</h2>
<section id="question-1-do-gardens-fill-seasonal-gaps-in-the-nectar-supply-of-farmland-landscapes" class="level3">
<h3 class="anchored" data-anchor-id="question-1-do-gardens-fill-seasonal-gaps-in-the-nectar-supply-of-farmland-landscapes"><strong>Question 1: Do gardens fill seasonal gaps in the nectar supply of farmland landscapes?</strong></h3>
<section id="generalised-additive-models" class="level4">
<h4 class="anchored" data-anchor-id="generalised-additive-models">Generalised Additive Models</h4>
<p>Generalised additive models (GAM) were used to model the smooth, non-linear trend in garden nectar availability over time. A thin-plate regression spline was used to model day of the year, with the degree of smoothing selected using the default generalised cross-validation method (Wood 2011).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">##############################################</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="do">######### GAM for garden nectar data #########</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="do">##############################################</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Load in the raw garden nectar values</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>nectar_data_garden <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Garden_nectar_production.csv"</span>) </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co">#We varied both the link function and the number of knots (from 2-12), to test for the best fitting GAM. The best-fitting model is shown below </span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>model3 <span class="ot">&lt;-</span> <span class="fu">gam</span>(sugar_grams_km2 <span class="sc">+</span> <span class="fl">0.0001</span> <span class="sc">~</span><span class="fu">s</span>(day, <span class="at">fx =</span> T, <span class="at">k=</span> <span class="dv">4</span>), <span class="do">## K=4 was the best model, assessed by comparing AIC scores and goodness of fit to data</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>              <span class="at">family =</span> <span class="fu">Gamma</span>(<span class="at">link =</span> <span class="st">"log"</span>),</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>              <span class="at">data =</span> nectar_data_garden)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model3) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Family: Gamma 
Link function: log 

Formula:
sugar_grams_km2 + 1e-04 ~ s(day, fx = T, k = 4)

Parametric coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  5.49997    0.06033   91.16   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Approximate significance of smooth terms:
       edf Ref.df     F  p-value    
s(day)   3      3 7.379 7.71e-05 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

R-sq.(adj) =  0.0351   Deviance explained = 4.14%
GCV = 1.8156  Scale est. = 1.7181    n = 472</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">gam.check</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Urban-rural-analysis-code_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>
Method: GCV   Optimizer: outer newton
Model required no smoothing parameter selectionModel rank =  4 / 4 

Basis dimension (k) checking results. Low p-value (k-index&lt;1) may
indicate that k is too low, especially if edf is close to k'.

       k' edf k-index p-value    
s(day)  3   3    0.71  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6099.285</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="do">##Using pred function to predict values for garden nectar for each day of the year</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>pdat <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">day =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">28</span>,<span class="dv">260</span>,<span class="dv">1</span>)) <span class="co">#predicts values for garden nectar for each day of the sampling season (Day 1 = March 01)</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span> (model3, <span class="at">newdata =</span> pdat, <span class="at">na.rm =</span> T, <span class="at">type=</span> <span class="st">"response"</span>, <span class="at">se.fit =</span> <span class="cn">TRUE</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>predframe <span class="ot">&lt;-</span> <span class="fu">data.frame</span> (pdat,<span class="at">level=</span><span class="dv">0</span>, <span class="at">preds =</span> pred<span class="sc">$</span>fit, <span class="at">se =</span> pred<span class="sc">$</span>se.fit)</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Save the model predictions to the working directory</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(predframe, <span class="st">"Garden_nectar_predictions.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="plot-the-nectar-phenology-of-each-habitat-figure-1" class="level4">
<h4 class="anchored" data-anchor-id="plot-the-nectar-phenology-of-each-habitat-figure-1">Plot the nectar phenology of each habitat (Figure 1)</h4>
<p>The following code is used to produce time series kite graphs from abundance data (in this case nectar abundance). The code is the same as used in Russo et al.2013 - Network-based phenological matching which is described in more detail here: https://rpubs.com/thoughtfulbloke/kitegraph</p>
<p>Kite graphs are produced for each habitat separately (to ensure equivalent scaling) and then joined later to produce a single plot (Figure 2a)</p>
<p>In addition to the kite plots, there is also code for plotting the proportional contribution of gardens to total farmland nectar supply (Figure 2b) as well as some code for plotting the actual nectar production of each habitat, rather than just relative production (Figure S4).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Load in data</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>habitat_nectar_phenology <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"habitat_nectar_phenology.csv"</span>) </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Split up dataset by habitat</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>garden_phenology<span class="ot">&lt;-</span>habitat_nectar_phenology[,<span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>)]</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>hedge_phenology<span class="ot">&lt;-</span>habitat_nectar_phenology[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">11</span>)]</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>pasture_phenology<span class="ot">&lt;-</span>habitat_nectar_phenology[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">7</span>)]</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>wood_phenology<span class="ot">&lt;-</span>habitat_nectar_phenology[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>)]</span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>margin_phenology<span class="ot">&lt;-</span>habitat_nectar_phenology[,<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">9</span>)]</span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a><span class="do">##############################</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a><span class="do">##### Plotting woodland data</span></span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a><span class="do">############################## </span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a><span class="do">###Setting up to print as an svg</span></span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a><span class="fu">svg</span>(<span class="st">"Woodland phenology kite diagram.svg"</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">width=</span><span class="dv">10</span>,<span class="at">height=</span><span class="dv">5</span>)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>graphType <span class="ot">&lt;-</span> <span class="st">"raw"</span> <span class="co">#sets if the data is raw numbers or abundance estimates</span></span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a><span class="do">###Selectively rescale the data</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a><span class="co">#because it is raw data, it divides the data (all but the first column) by the biggest entry (making everything between 0 and 1) then divides that result by 2 (making it all between 0 and 0.5)</span></span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (graphType <span class="sc">==</span> <span class="st">"raw"</span>){</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  wood_phenology[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(wood_phenology)] <span class="ot">&lt;-</span> (wood_phenology[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(wood_phenology)] <span class="sc">/</span> <span class="fu">max</span>(wood_phenology[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(wood_phenology)]))<span class="sc">/</span><span class="fl">1.9</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>wood_phenology <span class="ot">&lt;-</span> wood_phenology[<span class="fu">order</span>(wood_phenology[,<span class="dv">1</span>]),] <span class="co"># makes sure the data is in the right order - This just makes sure all the rows of the data are in numeric order based on the first column (the distance)</span></span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>wood_phenology2 <span class="ot">&lt;-</span> wood_phenology <span class="co">#make a full copy of the data (Because we need to go there and back, we are making a second copy.)</span></span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a><span class="co">#reverse the order in the second copy</span></span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>wood_phenology2 <span class="ot">&lt;-</span> wood_phenology2[<span class="fu">order</span>(wood_phenology2[,<span class="dv">1</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>),] <span class="co">#Because we need to go back again, we are reversing the order.</span></span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a><span class="co">#make the values negative</span></span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>wood_phenology2[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(wood_phenology2)] <span class="ot">&lt;-</span> wood_phenology2[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(wood_phenology2)] <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span> <span class="co">#We want to come back below the step level at the equivalent height so make our second set of data negative</span></span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a><span class="co">#stick the two sets of data together to make one</span></span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>wood_phenology <span class="ot">&lt;-</span> <span class="fu">rbind</span>(wood_phenology,wood_phenology2)</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a><span class="do">###Make a graph</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a><span class="co">#Because we are making a blank graph and building it up with the kites, we will start with working out the dimensions</span></span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>leftedge <span class="ot">&lt;-</span> <span class="fu">min</span>(wood_phenology[,<span class="dv">1</span>])</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>rightedge <span class="ot">&lt;-</span> <span class="fu">max</span>(wood_phenology[,<span class="dv">1</span>])</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>bottomedge <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>topedge <span class="ot">&lt;-</span> <span class="fu">ncol</span>(wood_phenology)</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a><span class="co">#we will also store the old woods and set new ones as we are tinkering with the amount of space on the left</span></span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>oldwoods <span class="ot">&lt;-</span> <span class="fu">par</span>()<span class="sc">$</span>mar</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="dv">12</span>,<span class="fl">0.5</span>))</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a><span class="co">#make the initial graph with no contents or y axis (this will appear in the plots tab in the lower right of RStudio)</span></span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(leftedge,rightedge), <span class="fu">c</span>(bottomedge,topedge), <span class="at">type=</span> <span class="st">"n"</span>, <span class="at">xlab=</span><span class="st">"Date"</span>, <span class="at">frame.plot=</span>F, <span class="at">yaxt=</span><span class="st">"n"</span>, <span class="at">ylab=</span><span class="st">""</span>,<span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb9-53"><a href="#cb9-53" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">labels=</span><span class="fu">names</span>(wood_phenology)[<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(wood_phenology)], <span class="at">at=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(wood_phenology)<span class="sc">-</span><span class="dv">1</span>), <span class="at">las=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">0</span>, <span class="at">font=</span><span class="dv">3</span>) <span class="co">#cex.axis=1</span></span>
<span id="cb9-54"><a href="#cb9-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-55"><a href="#cb9-55" aria-hidden="true" tabindex="-1"></a><span class="co">#Now loop through each column, making the kite plot for each by drawing a connect the points polygon</span></span>
<span id="cb9-56"><a href="#cb9-56" aria-hidden="true" tabindex="-1"></a>xValues <span class="ot">=</span> wood_phenology[,<span class="dv">1</span>]</span>
<span id="cb9-57"><a href="#cb9-57" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(wood_phenology)){</span>
<span id="cb9-58"><a href="#cb9-58" aria-hidden="true" tabindex="-1"></a>  yValues <span class="ot">=</span> i <span class="sc">+</span> wood_phenology[,i] <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb9-59"><a href="#cb9-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(xValues,yValues, <span class="at">col=</span><span class="fu">rgb</span>(<span class="fl">0.36</span>,<span class="fl">0.44</span>,<span class="fl">0.20</span>))</span>
<span id="cb9-60"><a href="#cb9-60" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb9-61"><a href="#cb9-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-62"><a href="#cb9-62" aria-hidden="true" tabindex="-1"></a><span class="co">#Finally, because we played with the wood setting, we will put them back to the defaults</span></span>
<span id="cb9-63"><a href="#cb9-63" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span>oldwoods)</span>
<span id="cb9-64"><a href="#cb9-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-65"><a href="#cb9-65" aria-hidden="true" tabindex="-1"></a><span class="co">#Add vertical dotted lines for each month</span></span>
<span id="cb9-66"><a href="#cb9-66" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">32</span>,<span class="dv">62</span>,<span class="dv">93</span>,<span class="dv">123</span>,<span class="dv">154</span>,<span class="dv">185</span>,<span class="dv">215</span>,<span class="dv">246</span>), <span class="at">col=</span><span class="st">"lightgray"</span>, <span class="at">lty=</span><span class="st">"dotted"</span>)</span>
<span id="cb9-67"><a href="#cb9-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-68"><a href="#cb9-68" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>() <span class="co">#End plot print</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">###########################</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="do">### Plotting hedgerow data</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="do">###########################</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="fu">svg</span>(<span class="st">"Hedgerow phenology kite diagram.svg"</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">width=</span><span class="dv">10</span>,<span class="at">height=</span><span class="dv">5</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>graphType <span class="ot">&lt;-</span> <span class="st">"raw"</span></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (graphType <span class="sc">==</span> <span class="st">"raw"</span>){</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  hedge_phenology[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(hedge_phenology)] <span class="ot">&lt;-</span> (hedge_phenology[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(hedge_phenology)] <span class="sc">/</span> <span class="fu">max</span>(hedge_phenology[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(hedge_phenology)]))<span class="sc">/</span><span class="fl">1.9</span></span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a><span class="do">###Setting up the data</span></span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a>hedge_phenology <span class="ot">&lt;-</span> hedge_phenology[<span class="fu">order</span>(hedge_phenology[,<span class="dv">1</span>]),] </span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>hedge_phenology2 <span class="ot">&lt;-</span> hedge_phenology</span>
<span id="cb11-16"><a href="#cb11-16" aria-hidden="true" tabindex="-1"></a>hedge_phenology2 <span class="ot">&lt;-</span> hedge_phenology2[<span class="fu">order</span>(hedge_phenology2[,<span class="dv">1</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb11-17"><a href="#cb11-17" aria-hidden="true" tabindex="-1"></a>hedge_phenology2[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(hedge_phenology2)] <span class="ot">&lt;-</span> hedge_phenology2[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(hedge_phenology2)] <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span> </span>
<span id="cb11-18"><a href="#cb11-18" aria-hidden="true" tabindex="-1"></a>hedge_phenology <span class="ot">&lt;-</span> <span class="fu">rbind</span>(hedge_phenology,hedge_phenology2)</span>
<span id="cb11-19"><a href="#cb11-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-20"><a href="#cb11-20" aria-hidden="true" tabindex="-1"></a><span class="do">###Make a graph</span></span>
<span id="cb11-21"><a href="#cb11-21" aria-hidden="true" tabindex="-1"></a>leftedge <span class="ot">&lt;-</span> <span class="fu">min</span>(hedge_phenology[,<span class="dv">1</span>])</span>
<span id="cb11-22"><a href="#cb11-22" aria-hidden="true" tabindex="-1"></a>rightedge <span class="ot">&lt;-</span> <span class="fu">max</span>(hedge_phenology[,<span class="dv">1</span>])</span>
<span id="cb11-23"><a href="#cb11-23" aria-hidden="true" tabindex="-1"></a>bottomedge <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb11-24"><a href="#cb11-24" aria-hidden="true" tabindex="-1"></a>topedge <span class="ot">&lt;-</span> <span class="fu">ncol</span>(hedge_phenology)</span>
<span id="cb11-25"><a href="#cb11-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-26"><a href="#cb11-26" aria-hidden="true" tabindex="-1"></a>oldMargins <span class="ot">&lt;-</span> <span class="fu">par</span>()<span class="sc">$</span>mar</span>
<span id="cb11-27"><a href="#cb11-27" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb11-28"><a href="#cb11-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-29"><a href="#cb11-29" aria-hidden="true" tabindex="-1"></a><span class="co">#make the initial graph with no contents or y axis (this will appear in the plots tab in the lower right of RStudio)</span></span>
<span id="cb11-30"><a href="#cb11-30" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(leftedge,rightedge), <span class="fu">c</span>(bottomedge,topedge), <span class="at">type=</span> <span class="st">"n"</span>, <span class="at">xlab=</span><span class="st">"Date"</span>, <span class="at">frame.plot=</span>F, <span class="at">yaxt=</span><span class="st">"n"</span>, <span class="at">ylab=</span><span class="st">""</span>,<span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb11-31"><a href="#cb11-31" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">labels=</span><span class="fu">names</span>(hedge_phenology)[<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(hedge_phenology)], <span class="at">at=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(hedge_phenology)<span class="sc">-</span><span class="dv">1</span>), <span class="at">las=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">0</span>, <span class="at">font=</span><span class="dv">3</span>) <span class="co">#cex.axis=1</span></span>
<span id="cb11-32"><a href="#cb11-32" aria-hidden="true" tabindex="-1"></a>xValues <span class="ot">=</span> hedge_phenology[,<span class="dv">1</span>]</span>
<span id="cb11-33"><a href="#cb11-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(hedge_phenology)){</span>
<span id="cb11-34"><a href="#cb11-34" aria-hidden="true" tabindex="-1"></a>  yValues <span class="ot">=</span> i <span class="sc">+</span> hedge_phenology[,i] <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb11-35"><a href="#cb11-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(xValues,yValues, <span class="at">col=</span><span class="fu">rgb</span>(<span class="fl">0.56</span>,<span class="fl">0.22</span>,<span class="fl">0.21</span>))</span>
<span id="cb11-36"><a href="#cb11-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb11-37"><a href="#cb11-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-38"><a href="#cb11-38" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span>oldMargins)</span>
<span id="cb11-39"><a href="#cb11-39" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">32</span>,<span class="dv">62</span>,<span class="dv">93</span>,<span class="dv">123</span>,<span class="dv">154</span>,<span class="dv">185</span>,<span class="dv">215</span>,<span class="dv">246</span>), <span class="at">col=</span><span class="st">"lightgray"</span>, <span class="at">lty=</span><span class="st">"dotted"</span>)</span>
<span id="cb11-40"><a href="#cb11-40" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">################################### </span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="do">##### Plotting Field margin data</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="do">###################################</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">svg</span>(<span class="st">"Margin phenology kite diagram.svg"</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">width=</span><span class="dv">10</span>,<span class="at">height=</span><span class="dv">5</span>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>graphType <span class="ot">&lt;-</span> <span class="st">"raw"</span> </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a><span class="do">###Selectively rescale the data</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (graphType <span class="sc">==</span> <span class="st">"raw"</span>){</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  margin_phenology[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(margin_phenology)] <span class="ot">&lt;-</span> (margin_phenology[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(margin_phenology)] <span class="sc">/</span> <span class="fu">max</span>(margin_phenology[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(margin_phenology)]))<span class="sc">/</span><span class="fl">1.9</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="do">###Setting up the data</span></span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>margin_phenology <span class="ot">&lt;-</span> margin_phenology[<span class="fu">order</span>(margin_phenology[,<span class="dv">1</span>]),] </span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>margin_phenology2 <span class="ot">&lt;-</span> margin_phenology</span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>margin_phenology2 <span class="ot">&lt;-</span> margin_phenology2[<span class="fu">order</span>(margin_phenology2[,<span class="dv">1</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>),]</span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a>margin_phenology2[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(margin_phenology2)] <span class="ot">&lt;-</span> margin_phenology2[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(margin_phenology2)] <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span> </span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a>margin_phenology <span class="ot">&lt;-</span> <span class="fu">rbind</span>(margin_phenology,margin_phenology2)</span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="do">###Make a graph</span></span>
<span id="cb13-22"><a href="#cb13-22" aria-hidden="true" tabindex="-1"></a>leftedge <span class="ot">&lt;-</span> <span class="fu">min</span>(margin_phenology[,<span class="dv">1</span>])</span>
<span id="cb13-23"><a href="#cb13-23" aria-hidden="true" tabindex="-1"></a>rightedge <span class="ot">&lt;-</span> <span class="fu">max</span>(margin_phenology[,<span class="dv">1</span>])</span>
<span id="cb13-24"><a href="#cb13-24" aria-hidden="true" tabindex="-1"></a>bottomedge <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb13-25"><a href="#cb13-25" aria-hidden="true" tabindex="-1"></a>topedge <span class="ot">&lt;-</span> <span class="fu">ncol</span>(margin_phenology)</span>
<span id="cb13-26"><a href="#cb13-26" aria-hidden="true" tabindex="-1"></a>oldMargins <span class="ot">&lt;-</span> <span class="fu">par</span>()<span class="sc">$</span>mar</span>
<span id="cb13-27"><a href="#cb13-27" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="dv">12</span>,<span class="fl">0.5</span>))</span>
<span id="cb13-28"><a href="#cb13-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-29"><a href="#cb13-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(leftedge,rightedge), <span class="fu">c</span>(bottomedge,topedge), <span class="at">type=</span> <span class="st">"n"</span>, <span class="at">xlab=</span><span class="st">"Date"</span>, <span class="at">frame.plot=</span>F, <span class="at">yaxt=</span><span class="st">"n"</span>, <span class="at">ylab=</span><span class="st">""</span>,<span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb13-30"><a href="#cb13-30" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">labels=</span><span class="fu">names</span>(margin_phenology)[<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(margin_phenology)], <span class="at">at=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(margin_phenology)<span class="sc">-</span><span class="dv">1</span>), <span class="at">las=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">0</span>, <span class="at">font=</span><span class="dv">3</span>) <span class="co">#cex.axis=1</span></span>
<span id="cb13-31"><a href="#cb13-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-32"><a href="#cb13-32" aria-hidden="true" tabindex="-1"></a>xValues <span class="ot">=</span> margin_phenology[,<span class="dv">1</span>]</span>
<span id="cb13-33"><a href="#cb13-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(margin_phenology)){</span>
<span id="cb13-34"><a href="#cb13-34" aria-hidden="true" tabindex="-1"></a>  yValues <span class="ot">=</span> i <span class="sc">+</span> margin_phenology[,i] <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb13-35"><a href="#cb13-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(xValues,yValues, <span class="at">col=</span><span class="fu">rgb</span>(<span class="fl">0.54</span>,<span class="fl">0.32</span>,<span class="fl">0.14</span>))</span>
<span id="cb13-36"><a href="#cb13-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb13-37"><a href="#cb13-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-38"><a href="#cb13-38" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span>oldMargins)</span>
<span id="cb13-39"><a href="#cb13-39" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">32</span>,<span class="dv">62</span>,<span class="dv">93</span>,<span class="dv">123</span>,<span class="dv">154</span>,<span class="dv">185</span>,<span class="dv">215</span>,<span class="dv">246</span>), <span class="at">col=</span><span class="st">"lightgray"</span>, <span class="at">lty=</span><span class="st">"dotted"</span>)</span>
<span id="cb13-40"><a href="#cb13-40" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">##############################</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="do">##### Plotting Pasture data</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="do">##############################</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="fu">svg</span>(<span class="st">"Pasture phenology kite diagram.svg"</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">width=</span><span class="dv">10</span>,<span class="at">height=</span><span class="dv">5</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>graphType <span class="ot">&lt;-</span> <span class="st">"raw"</span> <span class="co">#sets if the data is raw numbers or abundance estimates</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="do">###Selectively rescale the data</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (graphType <span class="sc">==</span> <span class="st">"raw"</span>){</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  pasture_phenology[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(pasture_phenology)] <span class="ot">&lt;-</span> (pasture_phenology[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(pasture_phenology)] <span class="sc">/</span> <span class="fu">max</span>(pasture_phenology[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(pasture_phenology)]))<span class="sc">/</span><span class="fl">1.9</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="do">###Setting up the data</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>pasture_phenology <span class="ot">&lt;-</span> pasture_phenology[<span class="fu">order</span>(pasture_phenology[,<span class="dv">1</span>]),] </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>pasture_phenology2 <span class="ot">&lt;-</span> pasture_phenology </span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>pasture_phenology2 <span class="ot">&lt;-</span> pasture_phenology2[<span class="fu">order</span>(pasture_phenology2[,<span class="dv">1</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>),] </span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>pasture_phenology2[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(pasture_phenology2)] <span class="ot">&lt;-</span> pasture_phenology2[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(pasture_phenology2)] <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span> </span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>pasture_phenology <span class="ot">&lt;-</span> <span class="fu">rbind</span>(pasture_phenology,pasture_phenology2)</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a><span class="do">###Make a graph</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>leftedge <span class="ot">&lt;-</span> <span class="fu">min</span>(pasture_phenology[,<span class="dv">1</span>])</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>rightedge <span class="ot">&lt;-</span> <span class="fu">max</span>(pasture_phenology[,<span class="dv">1</span>])</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>bottomedge <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>topedge <span class="ot">&lt;-</span> <span class="fu">ncol</span>(pasture_phenology)</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a>oldMargins <span class="ot">&lt;-</span> <span class="fu">par</span>()<span class="sc">$</span>mar</span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(leftedge,rightedge), <span class="fu">c</span>(bottomedge,topedge), <span class="at">type=</span> <span class="st">"n"</span>, <span class="at">xlab=</span><span class="st">"Date"</span>, <span class="at">frame.plot=</span>F, <span class="at">yaxt=</span><span class="st">"n"</span>, <span class="at">ylab=</span><span class="st">""</span>,<span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">labels=</span><span class="fu">names</span>(pasture_phenology)[<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(pasture_phenology)], <span class="at">at=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(pasture_phenology)<span class="sc">-</span><span class="dv">1</span>), <span class="at">las=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">0</span>, <span class="at">font=</span><span class="dv">3</span>) <span class="co">#cex.axis=1</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>xValues <span class="ot">=</span> pasture_phenology[,<span class="dv">1</span>]</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(pasture_phenology)){</span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>  yValues <span class="ot">=</span> i <span class="sc">+</span> pasture_phenology[,i] <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(xValues,yValues, <span class="at">col=</span><span class="fu">rgb</span>(<span class="fl">0.19</span>,<span class="fl">0.32</span>,<span class="fl">0.48</span>))</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span>oldMargins)</span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">32</span>,<span class="dv">62</span>,<span class="dv">93</span>,<span class="dv">123</span>,<span class="dv">154</span>,<span class="dv">185</span>,<span class="dv">215</span>,<span class="dv">246</span>), <span class="at">col=</span><span class="st">"lightgray"</span>, <span class="at">lty=</span><span class="st">"dotted"</span>)</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">##############################</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="do">##### Plotting Garden data</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="do">##############################</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="fu">svg</span>(<span class="st">"Garden phenology kite diagram.svg"</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">width=</span><span class="dv">10</span>,<span class="at">height=</span><span class="dv">5</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>graphType <span class="ot">&lt;-</span> <span class="st">"raw"</span> </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="do">###Selectively rescale the data</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (graphType <span class="sc">==</span> <span class="st">"raw"</span>){</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  garden_phenology[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(garden_phenology)] <span class="ot">&lt;-</span> (garden_phenology[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(garden_phenology)] <span class="sc">/</span> <span class="fu">max</span>(garden_phenology[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(garden_phenology)]))<span class="sc">/</span><span class="fl">1.9</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a><span class="do">###Setting up the data</span></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>garden_phenology <span class="ot">&lt;-</span> garden_phenology[<span class="fu">order</span>(garden_phenology[,<span class="dv">1</span>]),] </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>garden_phenology2 <span class="ot">&lt;-</span> garden_phenology </span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>garden_phenology2 <span class="ot">&lt;-</span> garden_phenology2[<span class="fu">order</span>(garden_phenology2[,<span class="dv">1</span>], <span class="at">decreasing =</span> <span class="cn">TRUE</span>),] </span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>garden_phenology2[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(garden_phenology2)] <span class="ot">&lt;-</span> garden_phenology2[,<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(garden_phenology2)] <span class="sc">*</span> <span class="sc">-</span><span class="dv">1</span> </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>garden_phenology <span class="ot">&lt;-</span> <span class="fu">rbind</span>(garden_phenology,garden_phenology2)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a><span class="do">###Make a graph</span></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>leftedge <span class="ot">&lt;-</span> <span class="fu">min</span>(garden_phenology[,<span class="dv">1</span>])</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>rightedge <span class="ot">&lt;-</span> <span class="fu">max</span>(garden_phenology[,<span class="dv">1</span>])</span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>bottomedge <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>topedge <span class="ot">&lt;-</span> <span class="fu">ncol</span>(garden_phenology)</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>oldMargins <span class="ot">&lt;-</span> <span class="fu">par</span>()<span class="sc">$</span>mar</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">8</span>,<span class="dv">0</span>,<span class="fl">0.5</span>))</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">c</span>(leftedge,rightedge), <span class="fu">c</span>(bottomedge,topedge), <span class="at">type=</span> <span class="st">"n"</span>, <span class="at">xlab=</span><span class="st">"Date"</span>, <span class="at">frame.plot=</span>F, <span class="at">yaxt=</span><span class="st">"n"</span>, <span class="at">ylab=</span><span class="st">""</span>,<span class="at">xaxt=</span><span class="st">"n"</span>)</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="dv">2</span>, <span class="at">labels=</span><span class="fu">names</span>(garden_phenology)[<span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(garden_phenology)], <span class="at">at=</span><span class="dv">1</span><span class="sc">:</span>(<span class="fu">ncol</span>(garden_phenology)<span class="sc">-</span><span class="dv">1</span>), <span class="at">las=</span><span class="dv">2</span>, <span class="at">lty=</span><span class="dv">0</span>, <span class="at">font=</span><span class="dv">3</span>) <span class="co">#cex.axis=1</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>xValues <span class="ot">=</span> garden_phenology[,<span class="dv">1</span>]</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">ncol</span>(garden_phenology)){</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>  yValues <span class="ot">=</span> i <span class="sc">+</span> garden_phenology[,i] <span class="sc">-</span> <span class="dv">1</span></span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">polygon</span>(xValues,yValues, <span class="at">col=</span><span class="fu">rgb</span>(<span class="fl">0.19</span>,<span class="fl">0.32</span>,<span class="fl">0.48</span>))</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span>oldMargins)</span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">v=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">32</span>,<span class="dv">62</span>,<span class="dv">93</span>,<span class="dv">123</span>,<span class="dv">154</span>,<span class="dv">185</span>,<span class="dv">215</span>,<span class="dv">246</span>), <span class="at">col=</span><span class="st">"lightgray"</span>, <span class="at">lty=</span><span class="st">"dotted"</span>)</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">###################################################################################</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting proportional contribution of gardens to total landscape nectar (Fig. 1b)</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="do">###################################################################################</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Load in data</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>farm_garden_nectar <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Farm_garden_nectar_production.csv"</span>) </span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Subset to only the garden nectar data</span></span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>garden_data <span class="ot">&lt;-</span> farm_garden_nectar[farm_garden_nectar<span class="sc">$</span>habitat <span class="sc">==</span> <span class="st">"garden"</span>,] </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a><span class="co">#Plot proportional contribution of garden nectar to total landscape nectar (=daily garden nectar/SUM(garden+farmland nectar))</span></span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>Garden_prop_nectar <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(garden_data, <span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>prop_sugar)) <span class="sc">+</span> </span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> prop_sugar<span class="sc">-</span>prop_se), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> prop_sugar<span class="sc">+</span>prop_se), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fl">0.5</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span> <span class="co">#Adds a line to show the point at which garden nectar = farmland nectar</span></span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">22</span>) <span class="sc">+</span> </span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a>   <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">bquote</span>(<span class="st">""</span>),</span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>        <span class="at">y=</span><span class="fu">bquote</span>(<span class="st">"Garden nectar contribution"</span>)) <span class="sc">+</span> </span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>),</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a>         <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">1</span>)<span class="sc">+</span></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_text</span>(<span class="at">x=</span><span class="dv">100</span>, <span class="at">y=</span><span class="fl">0.55</span>, <span class="at">size=</span><span class="dv">6</span>, <span class="at">label=</span><span class="st">"Equal garden &amp; farmland nectar"</span>)</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>   </span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a><span class="co">#Set up and print the plot with a manually added x axis</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a><span class="fu">svg</span>(<span class="st">"Garden_prop_nectar_km2.svg"</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">width=</span><span class="dv">11</span>,<span class="at">height=</span><span class="dv">5</span>)</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mar=</span><span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">8</span>,<span class="dv">2</span>,<span class="dv">1</span>)) <span class="co">#sets the size of the margins around the plot to be slightly larger than the default settings</span></span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>Garden_prop_nectar <span class="sc">+</span> <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">"Date"</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">32</span>,<span class="dv">62</span>,<span class="dv">93</span>,<span class="dv">123</span>,<span class="dv">154</span>,<span class="dv">185</span>,<span class="dv">215</span>,<span class="dv">246</span>), </span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">labels=</span><span class="fu">c</span>( <span class="st">"March"</span>,<span class="st">"April"</span>,<span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"Aug"</span>,<span class="st">"Sept"</span>,<span class="st">"Oct"</span>,<span class="st">"Nov"</span>))</span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="do">###################################################################################</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting actual (rather than relative) values  per m2 for each habitat (Figure S4)</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="do">###################################################################################</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>pasture_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(habitat_nectar_phenology, <span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>pasture_grams_m2)) <span class="sc">+</span> </span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pasture_grams_m2<span class="sc">-</span>pasture_grams_m2_se), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> pasture_grams_m2<span class="sc">+</span>pasture_grams_m2_se), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">22</span>) <span class="sc">+</span> </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">bquote</span>(<span class="st">""</span>),</span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="fu">bquote</span>(<span class="st">"Sugar/m"</span><span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="st">"/day (grams)"</span>)) <span class="sc">+</span> <span class="co">#sets plot theme - there are various other themes available</span></span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>),</span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Pasture"</span>)<span class="sc">+</span></span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="fl">0.0065</span>)<span class="sc">+</span></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">"Date"</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">32</span>,<span class="dv">62</span>,<span class="dv">93</span>,<span class="dv">123</span>,<span class="dv">154</span>,<span class="dv">185</span>,<span class="dv">215</span>,<span class="dv">246</span>), <span class="at">labels=</span><span class="fu">c</span>( <span class="st">"March"</span>,<span class="st">"April"</span>,<span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"Aug"</span>,<span class="st">"Sept"</span>,<span class="st">"Oct"</span>,<span class="st">"Nov"</span>))</span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>hedgerow_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(habitat_nectar_phenology, <span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>hedgerow_grams_m2)) <span class="sc">+</span> </span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> hedgerow_grams_m2<span class="sc">-</span>hedgerow_grams_m2_se), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> hedgerow_grams_m2<span class="sc">+</span>hedgerow_grams_m2_se), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">22</span>) <span class="sc">+</span> </span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">bquote</span>(<span class="st">""</span>),</span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="fu">bquote</span>(<span class="st">"Sugar/m"</span><span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="st">"/day (grams)"</span>)) <span class="sc">+</span> <span class="co">#sets plot theme - there are various other themes available</span></span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>),</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Hedgerow"</span>)<span class="sc">+</span></span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="fl">0.065</span>)<span class="sc">+</span></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">"Date"</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">32</span>,<span class="dv">62</span>,<span class="dv">93</span>,<span class="dv">123</span>,<span class="dv">154</span>,<span class="dv">185</span>,<span class="dv">215</span>,<span class="dv">246</span>), <span class="at">labels=</span><span class="fu">c</span>( <span class="st">"March"</span>,<span class="st">"April"</span>,<span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"Aug"</span>,<span class="st">"Sept"</span>,<span class="st">"Oct"</span>,<span class="st">"Nov"</span>))</span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a>margin_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(habitat_nectar_phenology, <span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>margin_grams_m2)) <span class="sc">+</span> </span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> margin_grams_m2<span class="sc">-</span>margin_grams_m2_se), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> margin_grams_m2<span class="sc">+</span>margin_grams_m2_se), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">22</span>) <span class="sc">+</span> </span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">bquote</span>(<span class="st">""</span>),</span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="fu">bquote</span>(<span class="st">"Sugar/m"</span><span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="st">"/day (grams)"</span>)) <span class="sc">+</span> <span class="co">#sets plot theme - there are various other themes available</span></span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>),</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Margin"</span>)<span class="sc">+</span></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="fl">0.065</span>)<span class="sc">+</span></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">"Date"</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">32</span>,<span class="dv">62</span>,<span class="dv">93</span>,<span class="dv">123</span>,<span class="dv">154</span>,<span class="dv">185</span>,<span class="dv">215</span>,<span class="dv">246</span>), <span class="at">labels=</span><span class="fu">c</span>( <span class="st">"March"</span>,<span class="st">"April"</span>,<span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"Aug"</span>,<span class="st">"Sept"</span>,<span class="st">"Oct"</span>,<span class="st">"Nov"</span>))</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>woodland_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(habitat_nectar_phenology, <span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>woodland_grams_m2)) <span class="sc">+</span> </span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> woodland_grams_m2<span class="sc">-</span>woodland_grams_m2_se), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> woodland_grams_m2<span class="sc">+</span>woodland_grams_m2_se), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">22</span>) <span class="sc">+</span> </span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">bquote</span>(<span class="st">""</span>),</span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="fu">bquote</span>(<span class="st">"Sugar/m"</span><span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="st">"/day (grams)"</span>)) <span class="sc">+</span> <span class="co">#sets plot theme - there are various other themes available</span></span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>),</span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Woodland"</span>)<span class="sc">+</span></span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="fl">0.065</span>)<span class="sc">+</span></span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">"Date"</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">32</span>,<span class="dv">62</span>,<span class="dv">93</span>,<span class="dv">123</span>,<span class="dv">154</span>,<span class="dv">185</span>,<span class="dv">215</span>,<span class="dv">246</span>), <span class="at">labels=</span><span class="fu">c</span>( <span class="st">"March"</span>,<span class="st">"April"</span>,<span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"Aug"</span>,<span class="st">"Sept"</span>,<span class="st">"Oct"</span>,<span class="st">"Nov"</span>))</span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>garden_plot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(habitat_nectar_phenology, <span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>garden_grams_m2)) <span class="sc">+</span> </span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> garden_grams_m2<span class="sc">-</span>garden_grams_m2_se), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> garden_grams_m2<span class="sc">+</span>garden_grams_m2_se), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="dv">0</span>), <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linetype =</span> <span class="st">"dotted"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">22</span>) <span class="sc">+</span> </span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">bquote</span>(<span class="st">""</span>),</span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="fu">bquote</span>(<span class="st">"Sugar/m"</span><span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="st">"/day (grams)"</span>)) <span class="sc">+</span> <span class="co">#sets plot theme - there are various other themes available</span></span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>),</span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">"Garden"</span>)<span class="sc">+</span></span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="fl">0.065</span>)<span class="sc">+</span></span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">"Date"</span>, <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">32</span>,<span class="dv">62</span>,<span class="dv">93</span>,<span class="dv">123</span>,<span class="dv">154</span>,<span class="dv">185</span>,<span class="dv">215</span>,<span class="dv">246</span>), <span class="at">labels=</span><span class="fu">c</span>( <span class="st">"March"</span>,<span class="st">"April"</span>,<span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"Aug"</span>,<span class="st">"Sept"</span>,<span class="st">"Oct"</span>,<span class="st">"Nov"</span>))</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>habitat_nectar_plots <span class="ot">&lt;-</span> <span class="fu">ggarrange</span>(hedgerow_plot, margin_plot, woodland_plot, garden_plot,pasture_plot, <span class="at">nrow =</span> <span class="dv">3</span>,<span class="at">ncol=</span><span class="dv">2</span>, <span class="at">labels=</span><span class="st">"auto"</span>,  <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend=</span><span class="st">"right"</span>)</span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot=</span>habitat_nectar_plots, <span class="at">filename=</span><span class="st">"Habitat_nectar_m2.svg"</span>, <span class="at">width=</span><span class="dv">13</span>, <span class="at">height=</span><span class="dv">12</span>, <span class="at">dpi=</span><span class="dv">500</span>)</span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a><span class="fu">ggsave</span>(<span class="at">plot=</span>habitat_nectar_plots, <span class="at">filename=</span><span class="st">"Habitat_nectar_m2.png"</span>, <span class="at">width=</span><span class="dv">13</span>, <span class="at">height=</span><span class="dv">12</span>, <span class="at">dpi=</span><span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="identifying-hunger-gaps-for-bumblebees-figure-2" class="level4">
<h4 class="anchored" data-anchor-id="identifying-hunger-gaps-for-bumblebees-figure-2">Identifying hunger gaps for bumblebees (Figure 2)</h4>
<p>This code plots the supply of farmland nectar per bee (i.e.&nbsp;nectar availability divided by bumblebee abundance at each timepoint) with and without the contribution of gardens. Superimposed on the graph is the total daily estimated nectar requirements of each bee, taken from Rotheray et al.&nbsp;2017.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Load in supply-demand data</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>supply_demand_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"Farm_garden_nectar_supply_demand.csv"</span>) </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting nectar supply vs demand + Std Err</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>supply_demand_plot<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(supply_demand_data, <span class="fu">aes</span>(<span class="at">x=</span>day, <span class="at">y=</span>total_sugar_per_bee, <span class="at">color=</span><span class="st">"coral1"</span>)) <span class="sc">+</span> </span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>( <span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">22</span>) <span class="sc">+</span>  <span class="co">#sets plot theme - there are various other themes available</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> total_sugar_per_bee<span class="sc">-</span>total_sugar_per_bee_se), <span class="at">color =</span> <span class="st">"coral1"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> total_sugar_per_bee<span class="sc">+</span>total_sugar_per_bee_se), <span class="at">color =</span> <span class="st">"coral1"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> bee_demand), <span class="at">color =</span> <span class="st">"black"</span>,  <span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> bee_demand), <span class="at">color =</span> <span class="st">"black"</span>,  <span class="at">size=</span><span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> bee_demand<span class="sc">-</span>bee_demand_se), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> bee_demand<span class="sc">+</span>bee_demand_se), <span class="at">color =</span> <span class="st">"black"</span>, <span class="at">linetype =</span> <span class="st">"dashed"</span>, <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> farm_sugar_per_bee), <span class="at">color =</span> <span class="st">"cyan3"</span>,  <span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y =</span> farm_sugar_per_bee), <span class="at">color =</span> <span class="st">"cyan3"</span>,  <span class="at">size=</span><span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> farm_sugar_per_bee<span class="sc">-</span>farm_sugar_per_bee_se), <span class="at">color =</span> <span class="st">"cyan3"</span>,<span class="at">linetype =</span> <span class="st">"dashed"</span>,  <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> farm_sugar_per_bee<span class="sc">+</span>farm_sugar_per_bee_se), <span class="at">color =</span> <span class="st">"cyan3"</span>,<span class="at">linetype =</span> <span class="st">"dashed"</span>,  <span class="at">size=</span><span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>                <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">bquote</span>(<span class="st">"Month"</span>),</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>             <span class="at">y=</span><span class="fu">bquote</span>(<span class="st">"Daily sugar per bee/km"</span> <span class="sc">^</span><span class="dv">2</span><span class="sc">*</span> <span class="st">"(grams)"</span>)) <span class="sc">+</span></span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>),</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>              <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>),</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="co">#Print supply-demand plot with manual x-axis</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a><span class="fu">svg</span>(<span class="st">"Farm_garden_Supply_demand_plusSE.svg"</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">width=</span><span class="dv">8</span>,<span class="at">height=</span><span class="fl">4.5</span>)</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(supply_demand_plot) <span class="sc">+</span> </span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">'log10'</span>,<span class="at">labels =</span> comma, <span class="at">limits=</span><span class="fu">c</span>(<span class="fl">0.01</span>, <span class="dv">100</span>))<span class="sc">+</span></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">name=</span><span class="st">"Date"</span>, <span class="at">breaks=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">32</span>,<span class="dv">62</span>,<span class="dv">93</span>,<span class="dv">123</span>,<span class="dv">154</span>,<span class="dv">185</span>,<span class="dv">215</span>,<span class="dv">246</span>), <span class="at">labels=</span> <span class="fu">c</span>(<span class="st">"March"</span>,<span class="st">"April"</span>,<span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"Aug"</span>,<span class="st">"Sept"</span>,<span class="st">"Oct"</span>,<span class="st">"Nov"</span>))</span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
</div>
</section>
</section>
<section id="question-2-do-pollinators-increase-their-use-of-gardens-during-gaps-in-farmland-resource-availability" class="level3">
<h3 class="anchored" data-anchor-id="question-2-do-pollinators-increase-their-use-of-gardens-during-gaps-in-farmland-resource-availability"><strong>Question 2: do pollinators increase their use of gardens during gaps in farmland resource availability?</strong></h3>
<p>Here we use BeeWalk data from transects in South-West UK to plot the pattern of bumblebee abundance in gardens vs farmland through the year</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Load data</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>beewalk_data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"BeeWalk data_South-West.csv"</span>) </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="do">##Split dataset up by species</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>BeeWalk_B.terr <span class="ot">&lt;-</span> beewalk_data[beewalk_data<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"B.terrestris"</span>,] </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>BeeWalk_B.lap <span class="ot">&lt;-</span> beewalk_data[beewalk_data<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"B.lapidarius"</span>,] </span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>BeeWalk_B.pasc <span class="ot">&lt;-</span> beewalk_data[beewalk_data<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"B.pascuorum"</span>,] </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>BeeWalk_B.prat <span class="ot">&lt;-</span> beewalk_data[beewalk_data<span class="sc">$</span>species <span class="sc">==</span> <span class="st">"B.pratorum"</span>,] </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a><span class="do">#### Plot each species' seasonal activity pattern as a 4-panel plot</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a><span class="fu">svg</span>(<span class="st">"Farm-garden_abundance_ratio_scaled.svg"</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">width=</span><span class="dv">13</span>,<span class="at">height=</span><span class="dv">9</span>) <span class="co">#Start svg print</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting B.terrestris</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gf_ratio_w_q_scaled <span class="sc">~</span> month, <span class="at">data =</span> BeeWalk_B.terr,</span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">"o"</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">4</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.axis=</span><span class="fl">1.5</span>,</span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Garden:Farm abundance ratio"</span>, </span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"B. terrestris"</span>, <span class="co"># labels x axis</span></span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab =</span> <span class="fl">1.5</span>,  <span class="at">las =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">"n"</span>,</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">10</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>),</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">"L"</span>) </span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"darkgray"</span>, <span class="at">lty=</span><span class="st">"dashed"</span>, <span class="at">lwd=</span><span class="dv">3</span>) <span class="co">#Add a line to show equal garden and farmland abundance</span></span>
<span id="cb24-25"><a href="#cb24-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-26"><a href="#cb24-26" aria-hidden="true" tabindex="-1"></a><span class="co">#Adding labels for months</span></span>
<span id="cb24-27"><a href="#cb24-27" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>), </span>
<span id="cb24-28"><a href="#cb24-28" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"March"</span>,<span class="st">"April"</span>,<span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"Aug"</span>,<span class="st">"Sept"</span>,<span class="st">"Oct"</span>),<span class="at">cex.axis=</span><span class="fl">1.5</span> )</span>
<span id="cb24-29"><a href="#cb24-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-30"><a href="#cb24-30" aria-hidden="true" tabindex="-1"></a><span class="do">## Plotting B.lapidarius</span></span>
<span id="cb24-31"><a href="#cb24-31" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gf_ratio_w_q_scaled <span class="sc">~</span> month, <span class="at">data =</span> BeeWalk_B.lap,</span>
<span id="cb24-32"><a href="#cb24-32" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">"o"</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">4</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.axis=</span><span class="fl">1.5</span>,</span>
<span id="cb24-33"><a href="#cb24-33" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Garden:Farm abundance ratio"</span>, </span>
<span id="cb24-34"><a href="#cb24-34" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"B. lapidarius"</span>, <span class="co"># labels x axis</span></span>
<span id="cb24-35"><a href="#cb24-35" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab =</span> <span class="fl">1.5</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb24-36"><a href="#cb24-36" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">"n"</span>, </span>
<span id="cb24-37"><a href="#cb24-37" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">10</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>),</span>
<span id="cb24-38"><a href="#cb24-38" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">"L"</span>)</span>
<span id="cb24-39"><a href="#cb24-39" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"darkgray"</span>, <span class="at">lty=</span><span class="st">"dashed"</span>, <span class="at">lwd=</span><span class="dv">3</span>) <span class="co">#Add a line to show equal garden and farmland abundance</span></span>
<span id="cb24-40"><a href="#cb24-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-41"><a href="#cb24-41" aria-hidden="true" tabindex="-1"></a><span class="co">#Adding labels for months</span></span>
<span id="cb24-42"><a href="#cb24-42" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>), </span>
<span id="cb24-43"><a href="#cb24-43" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"March"</span>,<span class="st">"April"</span>,<span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"Aug"</span>,<span class="st">"Sept"</span>,<span class="st">"Oct"</span>),<span class="at">cex.axis=</span><span class="fl">1.5</span> )</span>
<span id="cb24-44"><a href="#cb24-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-45"><a href="#cb24-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-46"><a href="#cb24-46" aria-hidden="true" tabindex="-1"></a><span class="do">##Plotting B.pascuorum</span></span>
<span id="cb24-47"><a href="#cb24-47" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gf_ratio_w_q_scaled <span class="sc">~</span> month, <span class="at">data =</span> BeeWalk_B.pasc,</span>
<span id="cb24-48"><a href="#cb24-48" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">"o"</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">4</span>, <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.axis=</span><span class="fl">1.5</span>,</span>
<span id="cb24-49"><a href="#cb24-49" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Garden:Farm abundance ratio"</span>, </span>
<span id="cb24-50"><a href="#cb24-50" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"B. pascuorum"</span>, <span class="co"># labels x axis</span></span>
<span id="cb24-51"><a href="#cb24-51" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab =</span> <span class="fl">1.5</span>,  <span class="at">las =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"black"</span>,  <span class="at">pch =</span> <span class="dv">20</span>,</span>
<span id="cb24-52"><a href="#cb24-52" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">"n"</span>, <span class="co"># suppresses the x axis labels</span></span>
<span id="cb24-53"><a href="#cb24-53" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">10</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>), </span>
<span id="cb24-54"><a href="#cb24-54" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">"L"</span>) <span class="co"># changes the box type to an L rather than square</span></span>
<span id="cb24-55"><a href="#cb24-55" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"darkgray"</span>, <span class="at">lty=</span><span class="st">"dashed"</span>, <span class="at">lwd=</span><span class="dv">3</span>) <span class="co">#Add a line to show equal garden and farmland abundance</span></span>
<span id="cb24-56"><a href="#cb24-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-57"><a href="#cb24-57" aria-hidden="true" tabindex="-1"></a><span class="co">#Adding labels for months</span></span>
<span id="cb24-58"><a href="#cb24-58" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>), </span>
<span id="cb24-59"><a href="#cb24-59" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"March"</span>,<span class="st">"April"</span>,<span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"Aug"</span>,<span class="st">"Sept"</span>,<span class="st">"Oct"</span>),<span class="at">cex.axis=</span><span class="fl">1.5</span> )</span>
<span id="cb24-60"><a href="#cb24-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-61"><a href="#cb24-61" aria-hidden="true" tabindex="-1"></a><span class="do">##Plotting B.pratorum</span></span>
<span id="cb24-62"><a href="#cb24-62" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(gf_ratio_w_q_scaled <span class="sc">~</span> month,  <span class="at">data =</span> BeeWalk_B.prat,</span>
<span id="cb24-63"><a href="#cb24-63" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">"o"</span>, <span class="at">lty=</span><span class="dv">1</span>, <span class="at">lwd=</span><span class="dv">4</span>,  <span class="at">font.lab=</span><span class="dv">2</span>, <span class="at">cex.axis=</span><span class="fl">1.5</span>,</span>
<span id="cb24-64"><a href="#cb24-64" aria-hidden="true" tabindex="-1"></a>     <span class="at">ylab =</span> <span class="st">"Garden:Farm abundance ratio"</span>, </span>
<span id="cb24-65"><a href="#cb24-65" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlab =</span> <span class="st">"B. pratorum"</span>, <span class="co"># labels x axis</span></span>
<span id="cb24-66"><a href="#cb24-66" aria-hidden="true" tabindex="-1"></a>     <span class="at">cex.lab =</span> <span class="fl">1.5</span>, <span class="at">las =</span> <span class="dv">1</span>, <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">pch =</span> <span class="dv">20</span>, </span>
<span id="cb24-67"><a href="#cb24-67" aria-hidden="true" tabindex="-1"></a>     <span class="at">xaxt =</span> <span class="st">"n"</span>, <span class="co"># suppresses the x axis labels</span></span>
<span id="cb24-68"><a href="#cb24-68" aria-hidden="true" tabindex="-1"></a>     <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">10</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>,<span class="dv">12</span>),</span>
<span id="cb24-69"><a href="#cb24-69" aria-hidden="true" tabindex="-1"></a>     <span class="at">bty =</span> <span class="st">"L"</span>)</span>
<span id="cb24-70"><a href="#cb24-70" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"darkgray"</span>, <span class="at">lty=</span><span class="st">"dashed"</span>, <span class="at">lwd=</span><span class="dv">3</span>) <span class="co">#Add a line to show equal garden and farmland abundance</span></span>
<span id="cb24-71"><a href="#cb24-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-72"><a href="#cb24-72" aria-hidden="true" tabindex="-1"></a><span class="co">#Adding labels for months</span></span>
<span id="cb24-73"><a href="#cb24-73" aria-hidden="true" tabindex="-1"></a><span class="fu">axis</span>(<span class="at">side =</span> <span class="dv">1</span>, <span class="at">at =</span> <span class="fu">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>,<span class="dv">9</span>,<span class="dv">10</span>), </span>
<span id="cb24-74"><a href="#cb24-74" aria-hidden="true" tabindex="-1"></a>     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"March"</span>,<span class="st">"April"</span>,<span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"Aug"</span>,<span class="st">"Sept"</span>,<span class="st">"Oct"</span>),<span class="at">cex.axis=</span><span class="fl">1.5</span> )</span>
<span id="cb24-75"><a href="#cb24-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-76"><a href="#cb24-76" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>() <span class="co">#End svg print</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
</div>
</section>
<section id="question-3-are-farmland-pollinator-populations-impacted-by-the-removal-or-alteration-of-garden-nectar-supply" class="level3">
<h3 class="anchored" data-anchor-id="question-3-are-farmland-pollinator-populations-impacted-by-the-removal-or-alteration-of-garden-nectar-supply"><strong>Question 3: are farmland pollinator populations impacted by the removal or alteration of garden nectar supply?</strong></h3>
<p>Here we analyse the outputs of an in-silico experiment using the agent-based model BEESTEWARD (TwistonDavies et al.&nbsp;2021) implemented in Netlogo. The model simulates the foraging behaviour, life history and colony growth of Bombus terrestris foraging for nectar and pollen in a spatially explicit, user-defined landscape. Our model landscapes were based on 12 real circular farmland landscapes with a 1 km radius (3.14 km2 area) in Southwest UK which were characterised and mapped by Anonymous et al.&nbsp;(2021a)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="do">####Loading in data from BEESTEWARD model simulations implemented in Netlogo </span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>experiment_outputs <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"BEESTEWARD seasonal outputs.csv"</span>) </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="co">#define the different variables</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>experiment_outputs<span class="sc">$</span>farm<span class="ot">=</span><span class="fu">as.factor</span>(experiment_outputs<span class="sc">$</span>farm)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>experiment_outputs<span class="sc">$</span>treatment<span class="ot">=</span><span class="fu">as.factor</span>(experiment_outputs<span class="sc">$</span>treatment)</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>experiment_outputs<span class="sc">$</span>endpoint<span class="ot">=</span><span class="fu">as.factor</span>(experiment_outputs<span class="sc">$</span>endpoint)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>experiment_outputs<span class="sc">$</span>month<span class="ot">=</span><span class="fu">as.factor</span>(experiment_outputs<span class="sc">$</span>month)</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a><span class="do">##Subset the data by the different variables measured in the experiment</span></span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>colony_density <span class="ot">&lt;-</span> experiment_outputs[experiment_outputs<span class="sc">$</span>endpoint <span class="sc">==</span> <span class="st">"ColonyDensity_km2"</span>,] </span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>colony_number <span class="ot">&lt;-</span> experiment_outputs[experiment_outputs<span class="sc">$</span>endpoint <span class="sc">==</span> <span class="st">"TotalColonies"</span>,] </span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>adult_queens <span class="ot">&lt;-</span> experiment_outputs[experiment_outputs<span class="sc">$</span>endpoint <span class="sc">==</span> <span class="st">"TotalAdultQueens"</span>,] </span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>adult_workers <span class="ot">&lt;-</span> experiment_outputs[experiment_outputs<span class="sc">$</span>endpoint <span class="sc">==</span> <span class="st">"TotalAdultWorkers"</span>,]</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>total_males <span class="ot">&lt;-</span> experiment_outputs[experiment_outputs<span class="sc">$</span>endpoint <span class="sc">==</span> <span class="st">"TotalMales"</span>,] </span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>total_bees <span class="ot">&lt;-</span> experiment_outputs[experiment_outputs<span class="sc">$</span>endpoint <span class="sc">==</span> <span class="st">"TotalBeesEverProduced"</span>,] </span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>total_colonies <span class="ot">&lt;-</span> experiment_outputs[experiment_outputs<span class="sc">$</span>endpoint <span class="sc">==</span> <span class="st">"TotalColoniesEverProduced"</span>,] </span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>total_active_bees <span class="ot">&lt;-</span> experiment_outputs[experiment_outputs<span class="sc">$</span>endpoint <span class="sc">==</span> <span class="st">"TotalActiveBees"</span>,] </span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>annual_cd <span class="ot">&lt;-</span> total_active_bees[total_active_bees<span class="sc">$</span>month <span class="sc">==</span> <span class="st">"March"</span>,]</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################</span></span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a><span class="do">##### Plotting colony density data by treatment and month ########</span></span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################</span></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a><span class="do">##Summarising data</span></span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>cd_month_summary <span class="ot">&lt;-</span> colony_density <span class="sc">%&gt;%</span> dplyr<span class="sc">::</span><span class="fu">group_by</span>(treatment, month) <span class="sc">%&gt;%</span></span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">summarize</span>(<span class="at">mean_months =</span> <span class="fu">mean</span>(month_mean), <span class="co"># calculate the mean for each group</span></span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">sd_months =</span> <span class="fu">sd</span>(month_mean)) <span class="co"># calculate the SD for each group</span></span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a><span class="do">##Reordering factors by name</span></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>cd_month_summary<span class="sc">$</span>month <span class="ot">&lt;-</span> <span class="fu">factor</span>(cd_month_summary<span class="sc">$</span>month, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"March"</span>,<span class="st">"April"</span>,<span class="st">"May"</span>,<span class="st">"June"</span>,<span class="st">"July"</span>,<span class="st">"Aug"</span>,<span class="st">"Sept"</span>,<span class="st">"Oct"</span>))</span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>cd_month_summary<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(cd_month_summary<span class="sc">$</span>treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"gdn"</span>,<span class="st">"alt gdn"</span>,<span class="st">"gdn pasture"</span>,<span class="st">"no gdn"</span>))</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a><span class="do">##Write summary to csv</span></span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a><span class="co">#write.csv(cd_month_summary , file="BEESTEWARD_colony density_monthly summary.csv")</span></span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a><span class="do">##Plotting the seasonality of colony density</span></span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>CD<span class="ot">&lt;-</span> <span class="fu">ggplot</span>(cd_month_summary, <span class="fu">aes</span>(<span class="at">x=</span>month, <span class="at">y=</span>mean_months, <span class="at">group=</span>treatment, <span class="at">color=</span>treatment)) <span class="sc">+</span> </span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>( <span class="at">size=</span><span class="dv">5</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="fl">0.1</span>))<span class="sc">+</span></span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>(<span class="at">base_size =</span> <span class="dv">22</span>) <span class="sc">+</span>  <span class="co">#sets plot theme - there are various other themes available</span></span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="fu">bquote</span>(<span class="st">"Month"</span>),</span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a>       <span class="at">y=</span><span class="fu">bquote</span>(<span class="st">"Mean colony density (nests/km"</span><span class="sc">^</span><span class="dv">2</span><span class="sc">*</span><span class="st">")"</span>)) <span class="sc">+</span></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>),</span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.text.y =</span> <span class="fu">element_text</span>(<span class="at">color=</span><span class="st">"black"</span>))<span class="sc">+</span></span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>mean_months<span class="sc">-</span>sd_months, <span class="at">ymax=</span>mean_months<span class="sc">+</span>sd_months), <span class="at">size=</span><span class="dv">1</span>, <span class="at">width=</span><span class="dv">0</span>,</span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>              <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="fl">0.2</span>))</span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a><span class="co">#Print the plot as an SVG</span></span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a><span class="fu">svg</span>(<span class="st">"BEESTEWARD_seasonal colony density.svg"</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">width=</span><span class="dv">10</span>,<span class="at">height=</span><span class="dv">5</span>)</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(CD <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#ee7621ff"</span>, <span class="st">"#f5dc83ff"</span>,  <span class="st">"#8fa33fff"</span>,  <span class="st">"#cdd4dcff"</span>),</span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a>                               <span class="at">name=</span><span class="st">"Treatment"</span>,</span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a>                               <span class="at">labels=</span><span class="fu">c</span>(<span class="st">"Garden"</span>, <span class="st">"Alternate garden"</span>, <span class="st">"Pasture replacement"</span>, <span class="st">"No garden"</span>))</span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>      <span class="sc">+</span><span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.8</span>, <span class="fl">0.8</span>)))</span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="do">############ Plots of BEESTEWARD model outputs #########################</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="do">####################################################################</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Number of colonies establishing in the spring</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>annual_cd<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(annual_cd<span class="sc">$</span>treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"gdn"</span>,<span class="st">"alt gdn"</span>,<span class="st">"gdn pasture"</span>,<span class="st">"no gdn"</span>))</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>sum_colonynumber <span class="ot">=</span> <span class="fu">summarySE</span>(annual_cd, <span class="at">measurevar =</span> <span class="st">"mean_annual_colonies"</span>, <span class="at">groupvars =</span> <span class="fu">c</span>(<span class="st">"treatment"</span>))</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>sum_colonynumber<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(sum_colonynumber<span class="sc">$</span>treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"gdn"</span>,<span class="st">"alt gdn"</span>,<span class="st">"gdn pasture"</span>,<span class="st">"no gdn"</span>))</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>mean_colony_numbers <span class="ot">&lt;-</span> sum_colonynumber <span class="sc">%&gt;%</span>  </span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>treatment, <span class="at">y=</span>mean_annual_colonies, <span class="at">color=</span>treatment)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">shape=</span><span class="dv">9</span>, <span class="at">stroke=</span><span class="fl">0.7</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span> <span class="co">#This bit plots the mean value for each habitat</span></span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data=</span>annual_cd, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>treatment, <span class="at">y=</span>mean_annual_colonies), <span class="at">size=</span><span class="dv">2</span>, <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> <span class="co">#This adds the actual real data points with a bit of sideways 'jitter' so that they aren't all overlapping</span></span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Total colonies per year"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="co">#This sets the plot theme (black and white) and labels the x and y axis manually so you can change the labels if you want</span></span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">130</span>),<span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">60</span>, <span class="dv">80</span>, <span class="dv">100</span>, <span class="dv">120</span>)) <span class="sc">+</span> <span class="co">#This adds a log scale which is quite complicated and normally not needed, but I think it's helpful for the cavity number </span></span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">70</span>, <span class="at">hjust =</span> <span class="dv">1</span>), <span class="co">#This just changes some of the settings like font size of labels etc</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> mean_colony_numbers <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#ee7621ff"</span>, <span class="st">"#f5dc83ff"</span>,  <span class="st">"#8fa33fff"</span>,  <span class="st">"#cdd4dcff"</span>))<span class="sc">+</span></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>                                         <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a><span class="co">#Number of adult queens</span></span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>sum_adultqueens <span class="ot">=</span> <span class="fu">summarySE</span>(adult_queens, <span class="at">measurevar =</span> <span class="st">"new_queens"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">groupvars =</span> <span class="fu">c</span>(<span class="st">"treatment"</span>))</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>sum_adultqueens<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(sum_adultqueens<span class="sc">$</span>treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"gdn"</span>,<span class="st">"alt gdn"</span>,<span class="st">"gdn pasture"</span>,<span class="st">"no gdn"</span>))</span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>adult_queen_plot <span class="ot">&lt;-</span> sum_adultqueens <span class="sc">%&gt;%</span>  </span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>treatment, <span class="at">y=</span>new_queens, <span class="at">color=</span>treatment)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">shape=</span><span class="dv">9</span>, <span class="at">stroke=</span><span class="fl">0.7</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span> <span class="co">#This bit plots the mean value for each habitat</span></span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data=</span>adult_queens, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>treatment, <span class="at">y=</span>new_queens), <span class="at">size=</span><span class="dv">2</span>, <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> <span class="co">#This adds the actual real data points with a bit of sideways 'jitter' so that they aren't all overlapping</span></span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"New queens produced"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="co">#This sets the plot theme (black and white) and labels the x and y axis manually so you can change the labels if you want</span></span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">300</span>), <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">150</span>, <span class="dv">200</span>, <span class="dv">250</span>, <span class="dv">300</span>)) <span class="sc">+</span> <span class="co">#This adds a log scale which is quite complicated and normally not needed, but I think it's helpful for the cavity number </span></span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">70</span>, <span class="at">hjust =</span> <span class="dv">1</span>), <span class="co">#This just changes some of the settings like font size of labels etc</span></span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> adult_queen_plot <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#ee7621ff"</span>, <span class="st">"#f5dc83ff"</span>,  <span class="st">"#8fa33fff"</span>,  <span class="st">"#cdd4dcff"</span>))<span class="sc">+</span></span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a><span class="co">#Spring queen survival</span></span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>sum_queensurvive <span class="ot">=</span> <span class="fu">summarySE</span>(adult_queens, <span class="at">measurevar =</span> <span class="st">"proportion_queens_surviving"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">groupvars =</span> <span class="fu">c</span>(<span class="st">"treatment"</span>))</span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>sum_queensurvive<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(sum_queensurvive<span class="sc">$</span>treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"gdn"</span>,<span class="st">"alt gdn"</span>,<span class="st">"gdn pasture"</span>,<span class="st">"no gdn"</span>))</span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>queen_survive_plot <span class="ot">&lt;-</span> sum_queensurvive <span class="sc">%&gt;%</span>  </span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>treatment, <span class="at">y=</span>proportion_queens_surviving<span class="sc">*</span><span class="dv">100</span>, <span class="at">color=</span>treatment)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">shape=</span><span class="dv">9</span>, <span class="at">stroke=</span><span class="fl">0.7</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span> <span class="co">#This bit plots the mean value for each habitat</span></span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data=</span>adult_queens, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>treatment, <span class="at">y=</span>proportion_queens_surviving<span class="sc">*</span><span class="dv">100</span>), <span class="at">size=</span><span class="dv">2</span>, <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> <span class="co">#This adds the actual real data points with a bit of sideways 'jitter' so that they aren't all overlapping</span></span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Spring queen survival (%)"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="co">#This sets the plot theme (black and white) and labels the x and y axis manually so you can change the labels if you want</span></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">17</span>, <span class="dv">25</span>), <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">18</span>, <span class="dv">20</span>, <span class="dv">22</span>, <span class="dv">24</span>)) <span class="sc">+</span> <span class="co">#This adds a log scale which is quite complicated and normally not needed, but I think it's helpful for the cavity number </span></span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">70</span>, <span class="at">hjust =</span> <span class="dv">1</span>), <span class="co">#This just changes some of the settings like font size of labels etc</span></span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> queen_survive_plot <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#ee7621ff"</span>, <span class="st">"#f5dc83ff"</span>,  <span class="st">"#8fa33fff"</span>,  <span class="st">"#cdd4dcff"</span>))<span class="sc">+</span></span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a><span class="co">#Total bee numbers</span></span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>sum_bee_numbers <span class="ot">=</span> <span class="fu">summarySE</span>(total_active_bees, <span class="at">measurevar =</span> <span class="st">"mean_annual_bees"</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">groupvars =</span> <span class="fu">c</span>(<span class="st">"treatment"</span>))</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>sum_bee_numbers<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(sum_bee_numbers<span class="sc">$</span>treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"gdn"</span>,<span class="st">"alt gdn"</span>,<span class="st">"gdn pasture"</span>,<span class="st">"no gdn"</span>))</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>bee_numbers_plot <span class="ot">&lt;-</span> sum_bee_numbers <span class="sc">%&gt;%</span>  </span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>treatment, <span class="at">y=</span>mean_annual_bees, <span class="at">color=</span>treatment)) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">size=</span><span class="dv">3</span>, <span class="at">shape=</span><span class="dv">9</span>, <span class="at">stroke=</span><span class="fl">0.7</span>, <span class="at">color=</span><span class="st">"black"</span>) <span class="sc">+</span> <span class="co">#This bit plots the mean value for each habitat</span></span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">data=</span>total_active_bees, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>treatment, <span class="at">y=</span>mean_annual_bees), <span class="at">size=</span><span class="dv">2</span>, <span class="at">width =</span> <span class="fl">0.2</span>) <span class="sc">+</span> <span class="co">#This adds the actual real data points with a bit of sideways 'jitter' so that they aren't all overlapping</span></span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Total bees per year"</span>) <span class="sc">+</span> <span class="fu">xlab</span>(<span class="st">""</span>) <span class="sc">+</span> <span class="co">#This sets the plot theme (black and white) and labels the x and y axis manually so you can change the labels if you want</span></span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">3000</span>, <span class="dv">12000</span>), <span class="at">breaks=</span><span class="fu">c</span>(<span class="dv">4000</span>,<span class="dv">6000</span>, <span class="dv">8000</span>, <span class="dv">10000</span>, <span class="dv">12000</span>)) <span class="sc">+</span> <span class="co">#This adds a log scale which is quite complicated and normally not needed, but I think it's helpful for the cavity number </span></span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>), <span class="at">axis.text.x=</span><span class="fu">element_text</span>(<span class="at">angle=</span><span class="dv">70</span>, <span class="at">hjust =</span> <span class="dv">1</span>), <span class="co">#This just changes some of the settings like font size of labels etc</span></span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a>        <span class="at">axis.title=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>))</span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a>plot4 <span class="ot">&lt;-</span> bee_numbers_plot <span class="sc">+</span> <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"#ee7621ff"</span>, <span class="st">"#f5dc83ff"</span>,  <span class="st">"#8fa33fff"</span>,  <span class="st">"#cdd4dcff"</span>))<span class="sc">+</span></span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a><span class="co">#TO PRODUCE ONE PANEL OF ALL PLOTS</span></span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a><span class="fu">svg</span>(<span class="st">"BEESTEWARD_model_outputs.svg"</span>, <span class="at">bg=</span><span class="st">"transparent"</span>, <span class="at">width=</span><span class="dv">6</span>,<span class="at">height=</span><span class="dv">6</span>)</span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a><span class="fu">grid.arrange</span>(plot1, plot2, plot3, plot4, <span class="at">ncol =</span> <span class="dv">2</span>, <span class="at">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a><span class="fu">dev.off</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>png 
  2 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">####################################################################</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a> <span class="do">############    Statistical analysis    #########################</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a> <span class="do">####################################################################</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="do">##Reordering factors by name</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a> colony_density<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(colony_density<span class="sc">$</span>treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"gdn"</span>,<span class="st">"alt gdn"</span>,<span class="st">"gdn pasture"</span>,<span class="st">"no gdn"</span>))</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>  <span class="do">##GLMM of mean yearly colony numbers</span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a> <span class="co">#Reordering factors by name</span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a> annual_cd<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(annual_cd<span class="sc">$</span>treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"gdn"</span>,<span class="st">"alt gdn"</span>,<span class="st">"gdn pasture"</span>,<span class="st">"no gdn"</span>))</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a> GLMM_CD <span class="ot">&lt;-</span> <span class="fu">lme</span>(mean_annual_colonies <span class="sc">~</span> treatment, <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>farm, <span class="at">method=</span><span class="st">"REML"</span>, <span class="at">data =</span> annual_cd)</span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(GLMM_CD)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: annual_cd 
       AIC      BIC    logLik
  334.9002 345.6054 -161.4501

Random effects:
 Formula: ~1 | farm
        (Intercept) Residual
StdDev:     4.77295 7.518942

Fixed effects:  mean_annual_colonies ~ treatment 
                         Value Std.Error DF  t-value p-value
(Intercept)          100.91194  2.570920 33 39.25130   0e+00
treatmentalt gdn     -13.94208  3.069595 33 -4.54199   1e-04
treatmentgdn pasture -11.63819  3.069595 33 -3.79144   6e-04
treatmentno gdn      -15.28938  3.069595 33 -4.98091   0e+00
 Correlation: 
                     (Intr) trtmntlg trtmnp
treatmentalt gdn     -0.597                
treatmentgdn pasture -0.597  0.500         
treatmentno gdn      -0.597  0.500    0.500

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-1.69513865 -0.63638669 -0.08749572  0.41862977  2.01801663 

Number of Observations: 48
Number of Groups: 12 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a> <span class="co">#Post-hoc test</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(<span class="fu">glht</span>(GLMM_CD, <span class="fu">emm</span>(pairwise <span class="sc">~</span> treatment)), <span class="at">test=</span><span class="fu">adjusted</span>(<span class="at">type=</span><span class="st">"bonferroni"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Fit: lme.formula(fixed = mean_annual_colonies ~ treatment, data = annual_cd, 
    random = ~1 | farm, method = "REML")

Linear Hypotheses:
                           Estimate Std. Error t value Pr(&gt;|t|)    
gdn - alt gdn == 0           13.942      3.070   4.542 0.000424 ***
gdn - gdn pasture == 0       11.638      3.070   3.791 0.003634 ** 
gdn - no gdn == 0            15.289      3.070   4.981 0.000117 ***
alt gdn - gdn pasture == 0   -2.304      3.070  -0.751 1.000000    
alt gdn - no gdn == 0         1.347      3.070   0.439 1.000000    
gdn pasture - no gdn == 0     3.651      3.070   1.189 1.000000    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- bonferroni method)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a> <span class="do">##GLMM of mean yearly bee numbers</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a> <span class="co">#Reordering factors by name</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a> total_active_bees <span class="ot">&lt;-</span> total_active_bees[total_active_bees<span class="sc">$</span>month <span class="sc">==</span> <span class="st">"March"</span>,]</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  total_active_bees<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(total_active_bees<span class="sc">$</span>treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"gdn"</span>,<span class="st">"alt gdn"</span>,<span class="st">"gdn pasture"</span>,<span class="st">"no gdn"</span>))</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a> annual_bees_GLMM <span class="ot">&lt;-</span>  <span class="fu">lme</span> (mean_annual_bees <span class="sc">~</span> treatment, <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>farm, <span class="at">method=</span><span class="st">"REML"</span>, <span class="at">data =</span> total_active_bees)     </span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(annual_bees_GLMM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: total_active_bees 
       AIC      BIC    logLik
  751.4084 762.1135 -369.7042

Random effects:
 Formula: ~1 | farm
        (Intercept) Residual
StdDev:    565.9566 847.7133

Fixed effects:  mean_annual_bees ~ treatment 
                         Value Std.Error DF   t-value p-value
(Intercept)           7894.382  294.2398 33 26.829757       0
treatmentalt gdn     -2074.871  346.0775 33 -5.995393       0
treatmentgdn pasture -1989.149  346.0775 33 -5.747698       0
treatmentno gdn      -2326.217  346.0775 33 -6.721664       0
 Correlation: 
                     (Intr) trtmntlg trtmnp
treatmentalt gdn     -0.588                
treatmentgdn pasture -0.588  0.500         
treatmentno gdn      -0.588  0.500    0.500

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-1.91848844 -0.46549428 -0.09311018  0.27144197  2.75512692 

Number of Observations: 48
Number of Groups: 12 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summary</span>(<span class="fu">glht</span>(annual_bees_GLMM, <span class="fu">emm</span>(pairwise <span class="sc">~</span> treatment)), <span class="at">test=</span><span class="fu">adjusted</span>(<span class="at">type=</span><span class="st">"bonferroni"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Fit: lme.formula(fixed = mean_annual_bees ~ treatment, data = total_active_bees, 
    random = ~1 | farm, method = "REML")

Linear Hypotheses:
                           Estimate Std. Error t value Pr(&gt;|t|)    
gdn - alt gdn == 0          2074.87     346.08   5.995 5.87e-06 ***
gdn - gdn pasture == 0      1989.15     346.08   5.748 1.22e-05 ***
gdn - no gdn == 0           2326.22     346.08   6.722 7.04e-07 ***
alt gdn - gdn pasture == 0   -85.72     346.08  -0.248        1    
alt gdn - no gdn == 0        251.35     346.08   0.726        1    
gdn pasture - no gdn == 0    337.07     346.08   0.974        1    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- bonferroni method)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a> <span class="do">##GLMM of max worker numbers</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a> <span class="co">#Reordering factors by name</span></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a> max_workers <span class="ot">&lt;-</span> adult_workers[adult_workers<span class="sc">$</span>month <span class="sc">==</span> <span class="st">"March"</span>,]</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a> max_workers<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(max_workers<span class="sc">$</span>treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"gdn"</span>,<span class="st">"alt gdn"</span>,<span class="st">"gdn pasture"</span>,<span class="st">"no gdn"</span>))</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a> max_workers_GLMM <span class="ot">&lt;-</span>  <span class="fu">lme</span> (max <span class="sc">~</span> treatment, <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>farm, <span class="at">method=</span><span class="st">"REML"</span>, <span class="at">data=</span> max_workers)     </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(max_workers_GLMM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: max_workers 
       AIC      BIC    logLik
  505.8712 516.5763 -246.9356

Random effects:
 Formula: ~1 | farm
        (Intercept) Residual
StdDev:    33.29103  52.4769

Fixed effects:  max ~ treatment 
                     Value Std.Error DF  t-value p-value
(Intercept)          734.6  17.93999 33 40.94763  0.0000
treatmentalt gdn     -75.4  21.42361 33 -3.51948  0.0013
treatmentgdn pasture -69.9  21.42361 33 -3.26276  0.0026
treatmentno gdn      -84.3  21.42361 33 -3.93491  0.0004
 Correlation: 
                     (Intr) trtmntlg trtmnp
treatmentalt gdn     -0.597                
treatmentgdn pasture -0.597  0.500         
treatmentno gdn      -0.597  0.500    0.500

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-1.78232692 -0.68759868 -0.05687217  0.49534824  1.88742878 

Number of Observations: 48
Number of Groups: 12 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(<span class="fu">glht</span>(max_workers_GLMM, <span class="fu">emm</span>(pairwise <span class="sc">~</span> treatment)), <span class="at">test=</span><span class="fu">adjusted</span>(<span class="at">type=</span><span class="st">"bonferroni"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Fit: lme.formula(fixed = max ~ treatment, data = max_workers, random = ~1 | 
    farm, method = "REML")

Linear Hypotheses:
                           Estimate Std. Error t value Pr(&gt;|t|)   
gdn - alt gdn == 0            75.40      21.42   3.519  0.00771 **
gdn - gdn pasture == 0        69.90      21.42   3.263  0.01541 * 
gdn - no gdn == 0             84.30      21.42   3.935  0.00243 **
alt gdn - gdn pasture == 0    -5.50      21.42  -0.257  1.00000   
alt gdn - no gdn == 0          8.90      21.42   0.415  1.00000   
gdn pasture - no gdn == 0     14.40      21.42   0.672  1.00000   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- bonferroni method)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a> <span class="do">##GLMM of percentage queen survival</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a> <span class="co">#Reordering factors by name</span></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a> queen_survival <span class="ot">&lt;-</span> adult_queens[adult_queens<span class="sc">$</span>month <span class="sc">==</span> <span class="st">"March"</span>,]</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a> queen_survival<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(queen_survival<span class="sc">$</span>treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"gdn"</span>,<span class="st">"alt gdn"</span>,<span class="st">"gdn pasture"</span>,<span class="st">"no gdn"</span>))</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a> queen_survival_GLMM <span class="ot">&lt;-</span>  <span class="fu">lme</span> (proportion_queens_surviving <span class="sc">~</span> treatment, <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>farm, <span class="at">method=</span><span class="st">"REML"</span>, <span class="at">data=</span> queen_survival)   </span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(queen_survival_GLMM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: queen_survival 
        AIC       BIC   logLik
  -260.0173 -249.3122 136.0086

Random effects:
 Formula: ~1 | farm
         (Intercept)    Residual
StdDev: 3.494863e-07 0.009823336

Fixed effects:  proportion_queens_surviving ~ treatment 
                           Value   Std.Error DF  t-value p-value
(Intercept)           0.21999626 0.002835753 33 77.57949  0.0000
treatmentalt gdn     -0.01299612 0.004010360 33 -3.24064  0.0027
treatmentgdn pasture -0.01047347 0.004010360 33 -2.61160  0.0135
treatmentno gdn      -0.01508829 0.004010360 33 -3.76233  0.0007
 Correlation: 
                     (Intr) trtmntlg trtmnp
treatmentalt gdn     -0.707                
treatmentgdn pasture -0.707  0.500         
treatmentno gdn      -0.707  0.500    0.500

Standardized Within-Group Residuals:
        Min          Q1         Med          Q3         Max 
-1.86146361 -0.76492723 -0.07244753  0.80225106  1.90696316 

Number of Observations: 48
Number of Groups: 12 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(<span class="fu">glht</span>(queen_survival_GLMM, <span class="fu">emm</span>(pairwise <span class="sc">~</span> treatment)), <span class="at">test=</span><span class="fu">adjusted</span>(<span class="at">type=</span><span class="st">"bonferroni"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Fit: lme.formula(fixed = proportion_queens_surviving ~ treatment, 
    data = queen_survival, random = ~1 | farm, method = "REML")

Linear Hypotheses:
                            Estimate Std. Error t value Pr(&gt;|t|)   
gdn - alt gdn == 0          0.012996   0.004010   3.241  0.01634 * 
gdn - gdn pasture == 0      0.010473   0.004010   2.612  0.08074 . 
gdn - no gdn == 0           0.015088   0.004010   3.762  0.00394 **
alt gdn - gdn pasture == 0 -0.002523   0.004010  -0.629  1.00000   
alt gdn - no gdn == 0       0.002092   0.004010   0.522  1.00000   
gdn pasture - no gdn == 0   0.004615   0.004010   1.151  1.00000   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- bonferroni method)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a> <span class="do">##GLMM of new queens</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a> <span class="co">#Reordering factors by name</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a> new_queens <span class="ot">&lt;-</span> adult_queens[adult_queens<span class="sc">$</span>month <span class="sc">==</span> <span class="st">"March"</span>,]</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a> new_queens<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(new_queens<span class="sc">$</span>treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"gdn"</span>,<span class="st">"alt gdn"</span>,<span class="st">"gdn pasture"</span>,<span class="st">"no gdn"</span>))</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a> new_queens_GLMM <span class="ot">&lt;-</span>  <span class="fu">lme</span> (new_queens <span class="sc">~</span> treatment, <span class="at">random =</span> <span class="sc">~</span><span class="dv">1</span><span class="sc">|</span>farm, <span class="at">method=</span><span class="st">"REML"</span>, <span class="at">data=</span> new_queens)    </span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(new_queens_GLMM)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Linear mixed-effects model fit by REML
  Data: new_queens 
       AIC      BIC    logLik
  432.0371 442.7422 -210.0185

Random effects:
 Formula: ~1 | farm
        (Intercept) Residual
StdDev:    21.93907 20.65288

Fixed effects:  new_queens ~ treatment 
                         Value Std.Error DF   t-value p-value
(Intercept)          222.76090  8.698009 33 25.610563  0.0000
treatmentalt gdn     -31.89375  8.431505 33 -3.782688  0.0006
treatmentgdn pasture -26.82139  8.431505 33 -3.181092  0.0032
treatmentno gdn      -44.04153  8.431505 33 -5.223448  0.0000
 Correlation: 
                     (Intr) trtmntlg trtmnp
treatmentalt gdn     -0.485                
treatmentgdn pasture -0.485  0.500         
treatmentno gdn      -0.485  0.500    0.500

Standardized Within-Group Residuals:
       Min         Q1        Med         Q3        Max 
-1.5906578 -0.4675731 -0.2303287  0.4388908  1.8075445 

Number of Observations: 48
Number of Groups: 12 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">summary</span>(<span class="fu">glht</span>(new_queens_GLMM, <span class="fu">emm</span>(pairwise <span class="sc">~</span> treatment)), <span class="at">test=</span><span class="fu">adjusted</span>(<span class="at">type=</span><span class="st">"bonferroni"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
     Simultaneous Tests for General Linear Hypotheses

Fit: lme.formula(fixed = new_queens ~ treatment, data = new_queens, 
    random = ~1 | farm, method = "REML")

Linear Hypotheses:
                           Estimate Std. Error t value Pr(&gt;|t|)    
gdn - alt gdn == 0           31.894      8.432   3.783  0.00372 ** 
gdn - gdn pasture == 0       26.821      8.432   3.181  0.01913 *  
gdn - no gdn == 0            44.042      8.432   5.223 5.73e-05 ***
alt gdn - gdn pasture == 0   -5.072      8.432  -0.602  1.00000    
alt gdn - no gdn == 0        12.148      8.432   1.441  0.95444    
gdn pasture - no gdn == 0    17.220      8.432   2.042  0.29504    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
(Adjusted p values reported -- bonferroni method)</code></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>  <span class="do">############################################################################</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a> <span class="do">#####            Summarising the most interesting variables            ########</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a> <span class="do">############################################################################</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a> <span class="do">###### ###### Summarising annual colony number results  ###### ######</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a> ac_outputs_grouped <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">group_by</span>(annual_cd, treatment) <span class="co"># group data by treatment </span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a> ac_output_summary <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">summarize</span>(ac_outputs_grouped,</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>                                <span class="at">mean_colonies =</span> <span class="fu">mean</span>(mean_annual_colonies), <span class="co"># calculate the mean for each group</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>                                <span class="at">sd_colonies =</span> <span class="fu">sd</span>(mean_annual_colonies)) <span class="co"># calculate the standard dev for each group</span></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a> <span class="do">##Reordering factors by name</span></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a> ac_output_summary<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(ac_output_summary<span class="sc">$</span>treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"gdn"</span>,<span class="st">"alt gdn"</span>,<span class="st">"gdn pasture"</span>,<span class="st">"no gdn"</span>))</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a> <span class="do">##Saving summary to csv</span></span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a> <span class="fu">write.csv</span>(ac_output_summary, <span class="at">file=</span><span class="st">"Annual colony numbers_summary.csv"</span>)</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a> <span class="do">###### ###### Summarising annual bee number results  ###### ######</span></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a> total_bees_grouped <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">group_by</span>(total_active_bees, treatment) <span class="co"># group data by treatment </span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a> total_bees_summary <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">summarize</span>(ac_outputs_grouped,</span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a>                                <span class="at">mean_bees =</span> <span class="fu">mean</span>(mean_annual_bees), <span class="co"># calculate the mean for each group</span></span>
<span id="cb50-23"><a href="#cb50-23" aria-hidden="true" tabindex="-1"></a>                                <span class="at">sd_bees =</span> <span class="fu">sd</span>(mean_annual_bees)) <span class="co"># calculate the standard deviation for each group</span></span>
<span id="cb50-24"><a href="#cb50-24" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a> <span class="do">##Reordering factors by name</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a> total_bees_summary<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(total_bees_summary<span class="sc">$</span>treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"gdn"</span>,<span class="st">"alt gdn"</span>,<span class="st">"gdn pasture"</span>,<span class="st">"no gdn"</span>))</span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a> <span class="do">##Saving summary to csv</span></span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a> <span class="fu">write.csv</span>(total_bees_summary, <span class="at">file=</span><span class="st">"Total bee numbers_summary.csv"</span>)</span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a> <span class="do">###### ###### Summarising max worker numbers  ###### ######</span></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a> max_workers <span class="ot">&lt;-</span> adult_workers[adult_workers<span class="sc">$</span>month <span class="sc">==</span> <span class="st">"March"</span>,]</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>  max_workers_grouped <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">group_by</span>(max_workers, treatment) <span class="co"># group data by treatment </span></span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a> max_workers_summary <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">summarize</span>(max_workers_grouped,</span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">mean_max_workers =</span> <span class="fu">mean</span>(max), <span class="co"># calculate the mean for each group</span></span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">sd_max_workers =</span> <span class="fu">sd</span>(max)) <span class="co"># calculate the standard deviation for each group</span></span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a> <span class="do">##Reordering factors by name</span></span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a> max_workers_summary<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(max_workers_summary<span class="sc">$</span>treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"gdn"</span>,<span class="st">"alt gdn"</span>,<span class="st">"gdn pasture"</span>,<span class="st">"no gdn"</span>))</span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a> <span class="do">##Saving summary to csv</span></span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a> <span class="fu">write.csv</span>(max_workers_summary, <span class="at">file=</span><span class="st">"Max worker numbers_summary.csv"</span>)</span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a> <span class="do">###### ###### Summarising queen proportion survival  ###### ######</span></span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a> queen_survival <span class="ot">&lt;-</span> adult_queens[adult_queens<span class="sc">$</span>month <span class="sc">==</span> <span class="st">"March"</span>,]</span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a> queen_survival_grouped <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">group_by</span>(queen_survival, treatment) <span class="co"># group data by treatment </span></span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a> queen_survival_summary <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">summarize</span>(queen_survival_grouped,</span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">mean_queen_survival =</span> <span class="fu">mean</span>(proportion_queens_surviving), <span class="co"># calculate the mean for each group</span></span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">sd_queen_survival =</span> <span class="fu">sd</span>(proportion_queens_surviving)) <span class="co"># calculate the standard deviation for each group</span></span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-53"><a href="#cb50-53" aria-hidden="true" tabindex="-1"></a> <span class="do">##Reordering factors by name</span></span>
<span id="cb50-54"><a href="#cb50-54" aria-hidden="true" tabindex="-1"></a> queen_survival_summary<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(queen_survival_summary<span class="sc">$</span>treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"gdn"</span>,<span class="st">"alt gdn"</span>,<span class="st">"gdn pasture"</span>,<span class="st">"no gdn"</span>))</span>
<span id="cb50-55"><a href="#cb50-55" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-56"><a href="#cb50-56" aria-hidden="true" tabindex="-1"></a> <span class="do">##Saving summary to csv</span></span>
<span id="cb50-57"><a href="#cb50-57" aria-hidden="true" tabindex="-1"></a> <span class="fu">write.csv</span>(queen_survival_summary, <span class="at">file=</span><span class="st">"Queen_survival_summary.csv"</span>)</span>
<span id="cb50-58"><a href="#cb50-58" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-59"><a href="#cb50-59" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-60"><a href="#cb50-60" aria-hidden="true" tabindex="-1"></a> <span class="do">###### ###### Summarising new queens  ###### ######</span></span>
<span id="cb50-61"><a href="#cb50-61" aria-hidden="true" tabindex="-1"></a> new_queens <span class="ot">&lt;-</span> adult_queens[adult_queens<span class="sc">$</span>month <span class="sc">==</span> <span class="st">"March"</span>,]</span>
<span id="cb50-62"><a href="#cb50-62" aria-hidden="true" tabindex="-1"></a> new_queens_grouped <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">group_by</span>(new_queens, treatment) <span class="co"># group data by treatment </span></span>
<span id="cb50-63"><a href="#cb50-63" aria-hidden="true" tabindex="-1"></a> new_queens_summary <span class="ot">&lt;-</span> dplyr<span class="sc">::</span><span class="fu">summarize</span>(new_queens_grouped,</span>
<span id="cb50-64"><a href="#cb50-64" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">mean_new_queens =</span> <span class="fu">mean</span>(new_queens), <span class="co"># calculate the mean for each group</span></span>
<span id="cb50-65"><a href="#cb50-65" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">sd_queen_mortality =</span> <span class="fu">sd</span>(new_queens)) <span class="co"># calculate the standard deviation for each group</span></span>
<span id="cb50-66"><a href="#cb50-66" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-67"><a href="#cb50-67" aria-hidden="true" tabindex="-1"></a> <span class="do">##Reordering factors by name</span></span>
<span id="cb50-68"><a href="#cb50-68" aria-hidden="true" tabindex="-1"></a> new_queens_summary<span class="sc">$</span>treatment <span class="ot">&lt;-</span> <span class="fu">factor</span>(new_queens_summary<span class="sc">$</span>treatment, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"gdn"</span>,<span class="st">"alt gdn"</span>,<span class="st">"gdn pasture"</span>,<span class="st">"no gdn"</span>))</span>
<span id="cb50-69"><a href="#cb50-69" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb50-70"><a href="#cb50-70" aria-hidden="true" tabindex="-1"></a> <span class="do">##Saving summary to csv</span></span>
<span id="cb50-71"><a href="#cb50-71" aria-hidden="true" tabindex="-1"></a> <span class="fu">write.csv</span>(new_queens_summary, <span class="at">file=</span><span class="st">"new_queens_summary.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="question-4-how-much-of-great-britain-is-within-reach-of-a-garden-for-a-foraging-pollinator" class="level3">
<h3 class="anchored" data-anchor-id="question-4-how-much-of-great-britain-is-within-reach-of-a-garden-for-a-foraging-pollinator"><strong>Question 4: how much of Great Britain is within reach of a garden for a foraging pollinator?</strong></h3>
<p>All analyses for this prediction were based on mapping data and was carried out in Arc GIS, therefore no code is shown here.</p>
</section>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p>Rotheray, E.L., Osborne, J.L. &amp; Goulson, D. (2017). Quantifying the food requirements and effects of food stress on bumble bee colony development. J Apicult Res, 56, 288-299.</p>
<p>Russo, L., DeBarros, N., Yang, S., Shea, K. and Mortensen, D., 2013. Supporting crop pollinators with floral resources: networkbased phenological matching. Ecology and evolution, 3(9), pp.3125-3140.</p>
<p>[Anonymous 2019] Details omitted for double-blind reviewing.</p>
<p>[Anonymous 20121] Details omitted for double-blind reviewing.</p>
<p>TwistonDavies, G., Becher, M.A.&nbsp;&amp; Osborne, J.L. (2021). BEESTEWARD: A research and decisionsupport software for effective land management to promote bumblebee populations. Methods Ecol Evol, 12, 1809-1815.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>